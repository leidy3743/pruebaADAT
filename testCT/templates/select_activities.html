{% extends "layouts/base.html" %}

{% block title %} Generador de Actividades {% endblock %} 

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}

  <div class="container-fluid py-4">
    <div class="row">
      <div class="col-12">
        <div class="card my-4">
          <div class="card-header p-0 position-relative mt-n4 mx-3 z-index-2">
            <div class="bg-gradient-primary shadow-primary border-radius-lg pt-4 pb-3">
              <h6 class="text-white text-capitalize ps-3">Generador de Actividades</h6>
            </div>
          </div>
          <div class="card-body px-4 pb-2">
            <div class="table-responsive p-0">
              <h8 class="text-primary">Selecciona los datos para generar las actividades</h8>
                <br>
              <form action="/crear_actividad" method="POST">
                <label for="grado">Grado:</label>
                <select name="grado" id="grado">
                    {% for grado in grados %}
                        <option value="{{ grado.id }}">{{ grado.nombre }}</option>
                    {% else %}
                        <option value="">No hay grados disponibles</option>
                    {% endfor %}
                </select><br><br>

                <!-- Selección de Asignatura -->
                <label for="asignatura">Asignatura:</label>
                <select name="asignatura" id="asignatura">
                    {% for asignatura in asignaturas %}
                        <option value="{{ asignatura.id }}">{{ asignatura.nombre }}</option>
                    {% else %}
                        <option value="">No hay asignaturas disponibles</option>
                    {% endfor %}
                </select><br><br>

                <label for="topic">Temática:</label>
                <input type="text" id="topic" name="topic" required><br><br>

                <!-- Selección de Habilidades -->
                <label for="habilidades">Habilidades:</label>
                <select name="habilidades" id="habilidades" multiple>
                    {% for habilidad in habilidades %}
                        <option value="{{ habilidad.id }}">{{ habilidad.nombre }}</option>
                    {% else %}
                        <option value="">No hay habilidades disponibles</option>
                    {% endfor %}
                </select><br><br>

                <label for="students">Cantidad de estudiantes:</label>
                <input type="number" id="students" name="students" required><br><br>

                <label for="time">Cantidad de tiempo (minutos):</label>
                <input type="number" id="time" name="time" required><br><br>

                <label for="resources">Recursos:</label>
                <input type="text" id="resources" name="resources"><br><br>

                <button type="submit">Generar Actividades</button>  
            </form>
            {% if actividades %}
        <h2>Actividades Generadas:</h2>
        <p>{{ actividades }}</p>
    {% endif %}
           
            </div>
          </div>
        </div>
      </div>
    </div>
    </div>
    <footer class="footer py-4  ">
      <div class="container-fluid">
        <div class="row align-items-center justify-content-lg-between">
          <div class="col-lg-6 mb-lg-0 mb-4">
            <div class="copyright text-center text-sm text-muted text-lg-start">
              © <script>
                document.write(new Date().getFullYear())
              </script>,
               <i class="fa fa-heart"></i> 
              <a href="https://www.creative-tim.com" class="font-weight-bold" target="_blank">Creative by</a>
              Universidad del Valle.
            </div>
          </div>
          <div class="col-lg-6">
            <ul class="nav nav-footer justify-content-center justify-content-lg-end">
              <li class="nav-item">
                <a href="https://www.creative-tim.com" class="nav-link text-muted" target="_blank">Creative Tim</a>
              </li>
              <li class="nav-item">
                <a href="https://www.creative-tim.com/presentation" class="nav-link text-muted" target="_blank">About Us</a>
              </li>
              <li class="nav-item">
                <a href="https://www.creative-tim.com/blog" class="nav-link text-muted" target="_blank">Blog</a>
              </li>
              <li class="nav-item">
                <a href="https://www.creative-tim.com/license" class="nav-link pe-0 text-muted" target="_blank">License</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
  </div>

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
<!-- Incluir jQuery y jQuery UI para el autocompletar -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script>
    $(document).ready(function(){
        // Cargar datos para selects desde la base de datos
        $.get('/get_form_data', function(data){
            data.grados.forEach(function(grade){
                $('#grade').append(new Option(grade.nombre, grade.id));
            });
            data.asignaturas.forEach(function(subject){
                $('#subject').append(new Option(subject.nombre, subject.id));
            });
            data.tematicas.forEach(function(topic){
                $('#topic').append(new Option(topic.nombre, topic.id));
            });
            data.habilidades.forEach(function(skill){
                $('#skill').append(new Option(skill.nombre, skill.id));
            });
        });

        // Autocompletar para recursos
        $("#resources").autocomplete({
            source: function(request, response) {
                $.getJSON("/autocomplete_recursos", { q: request.term }, function(data) {
                    response($.map(data, function(item) {
                        return {
                            label: item.nombre,
                            value: item.nombre
                        };
                    }));
                });
            },
            minLength: 2
        });
    });
</script>
{% block javascripts %}{% endblock javascripts %}
